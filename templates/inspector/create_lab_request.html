{% extends 'base.html' %}

{% block title %}–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–±—É - –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto space-y-8">
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <div class="bg-gradient-to-r from-purple-600 to-violet-700 rounded-xl p-6 text-white">
    <div class="flex items-center">
      <div class="w-12 h-12 bg-white bg-opacity-20 rounded-xl flex items-center justify-center mr-4">
        <i class="fas fa-vial text-2xl"></i>
      </div>
      <div>
        <h1 class="text-2xl font-bold">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–±—É</h1>
        <p class="text-purple-100 mt-1">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –≤ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—é</p>
      </div>
    </div>
  </div>

  <!-- –§–æ—Ä–º–∞ -->
  <form method="post" id="lab-request-form" class="space-y-8">
    {% csrf_token %}
    
    <!-- –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
      <div class="bg-gradient-to-r from-blue-50 to-indigo-50 px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900 flex items-center">
          <i class="fas fa-info-circle text-blue-500 mr-2"></i>
          –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        </h2>
      </div>
      <div class="p-6 space-y-6">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- –ü—Ä–æ–µ–∫—Ç -->
          <div>
            <label for="project_id" class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-building text-blue-500 mr-1"></i>
              –ü—Ä–æ–µ–∫—Ç <span class="text-red-500">*</span>
            </label>
            <select id="project_id" name="project_id" required
                   class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm">
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç</option>
              {% for project in projects %}
                <option value="{{ project.id }}">{{ project.name }}</option>
              {% endfor %}
            </select>
          </div>

          <!-- –¢–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∞ -->
          <div>
            <label for="material_type_id" class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-layer-group text-orange-500 mr-1"></i>
              –¢–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∞ <span class="text-red-500">*</span>
            </label>
            <select id="material_type_id" name="material_type_id" required
                   class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm">
              <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –º–∞—Ç–µ—Ä–∏–∞–ª–∞</option>
              {% for material_type in material_types %}
                <option value="{{ material_type.id }}">{{ material_type.name }}</option>
              {% endfor %}
            </select>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- –°—Ä–æ—á–Ω–æ—Å—Ç—å -->
          <div>
            <label for="urgency" class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-clock text-yellow-500 mr-1"></i>
              –°—Ä–æ—á–Ω–æ—Å—Ç—å
            </label>
            <select id="urgency" name="urgency" 
                   class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm">
              {% for urgency_value, urgency_label in urgency_levels %}
                <option value="{{ urgency_value }}" {% if urgency_value == 'normal' %}selected{% endif %}>
                  {{ urgency_label }}
                </option>
              {% endfor %}
            </select>
          </div>

          <!-- –û–∂–∏–¥–∞–µ–º–∞—è –¥–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
          <div>
            <label for="expected_results_date" class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-calendar-alt text-green-500 mr-1"></i>
              –û–∂–∏–¥–∞–µ–º–∞—è –¥–∞—Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            </label>
            <input type="date" id="expected_results_date" name="expected_results_date"
                   class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm">
          </div>
        </div>
      </div>
    </div>

    <!-- –î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏ -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
      <div class="bg-gradient-to-r from-green-50 to-emerald-50 px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900 flex items-center">
          <i class="fas fa-clipboard-list text-green-500 mr-2"></i>
          –î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏
        </h2>
      </div>
      <div class="p-6 space-y-6">
        <!-- –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ -->
        <div>
          <label for="reason" class="block text-sm font-semibold text-gray-700 mb-2">
            <i class="fas fa-question-circle text-blue-500 mr-1"></i>
            –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ <span class="text-red-500">*</span>
          </label>
          <textarea id="reason" name="reason" rows="4" required
                    class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm resize-vertical"
                    placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞..."></textarea>
          <p class="text-xs text-gray-500 mt-1">–ù–∞–ø—Ä–∏–º–µ—Ä: –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞, –ø–ª–∞–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞, –∂–∞–ª–æ–±—ã</p>
        </div>

        <!-- –¢—Ä–µ–±—É–µ–º—ã–µ –∞–Ω–∞–ª–∏–∑—ã -->
        <div>
          <label for="required_tests" class="block text-sm font-semibold text-gray-700 mb-2">
            <i class="fas fa-microscope text-purple-500 mr-1"></i>
            –¢—Ä–µ–±—É–µ–º—ã–µ –∞–Ω–∞–ª–∏–∑—ã <span class="text-red-500">*</span>
          </label>
          <textarea id="required_tests" name="required_tests" rows="3" required
                    class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm resize-vertical"
                    placeholder="–£–∫–∞–∂–∏—Ç–µ –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –∞–Ω–∞–ª–∏–∑—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Å—Ç–∏..."></textarea>
          <p class="text-xs text-gray-500 mt-1">–ù–∞–ø—Ä–∏–º–µ—Ä: –ø—Ä–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Å–∂–∞—Ç–∏–µ, –º–æ—Ä–æ–∑–æ—Å—Ç–æ–π–∫–æ—Å—Ç—å, —Ö–∏–º–∏—á–µ—Å–∫–∏–π —Å–æ—Å—Ç–∞–≤</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑—Ü–æ–≤ -->
          <div>
            <label for="sample_quantity" class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-weight text-orange-500 mr-1"></i>
              –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑—Ü–æ–≤ <span class="text-red-500">*</span>
            </label>
            <input type="text" id="sample_quantity" name="sample_quantity" required
                   class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm"
                   placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 3 –æ–±—Ä–∞–∑—Ü–∞ –ø–æ 1–∫–≥">
            <p class="text-xs text-gray-500 mt-1">–£–∫–∞–∂–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏ –≤–µ—Å/–æ–±—ä–µ–º –æ–±—Ä–∞–∑—Ü–æ–≤</p>
          </div>

          <!-- –ú–µ—Å—Ç–æ –æ—Ç–±–æ—Ä–∞ -->
          <div>
            <label for="sampling_location_description" class="block text-sm font-semibold text-gray-700 mb-2">
              <i class="fas fa-map-marker-alt text-red-500 mr-1"></i>
              –ú–µ—Å—Ç–æ –æ—Ç–±–æ—Ä–∞ –ø—Ä–æ–±—ã <span class="text-red-500">*</span>
            </label>
            <input type="text" id="sampling_location_description" name="sampling_location_description" required
                   class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm"
                   placeholder="–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –æ–±—ä–µ–∫—Ç–µ">
            <p class="text-xs text-gray-500 mt-1">–ù–∞–ø—Ä–∏–º–µ—Ä: —É—á–∞—Å—Ç–æ–∫ 1, —Å–µ–∫—Ü–∏—è –ê, –≥–ª—É–±–∏–Ω–∞ 2–º</p>
          </div>
        </div>
      </div>
    </div>

    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden">
      <div class="bg-gradient-to-r from-yellow-50 to-amber-50 px-6 py-4 border-b border-gray-200">
        <h2 class="text-lg font-semibold text-gray-900 flex items-center">
          <i class="fas fa-sticky-note text-yellow-500 mr-2"></i>
          –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        </h2>
      </div>
      <div class="p-6">
        <!-- –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞ -->
        <div>
          <label for="inspector_notes" class="block text-sm font-semibold text-gray-700 mb-2">
            <i class="fas fa-comment-alt text-indigo-500 mr-1"></i>
            –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∏ –æ—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
          </label>
          <textarea id="inspector_notes" name="inspector_notes" rows="3"
                    class="block w-full rounded-lg border border-gray-300 px-3 py-3 text-gray-900 placeholder-gray-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors shadow-sm resize-vertical"
                    placeholder="–£–∫–∞–∂–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ—Ç–±–æ—Ä—É –ø—Ä–æ–± –∏–ª–∏ –∞–Ω–∞–ª–∏–∑—É..."></textarea>
          <p class="text-xs text-gray-500 mt-1">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∏–ª–∏ –≤–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è</p>
        </div>
      </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
    <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-6">
      <div class="flex flex-col sm:flex-row justify-between items-center space-y-4 sm:space-y-0 sm:space-x-4">
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-info-circle text-blue-500 mr-2"></i>
          –ü–æ–ª—è –æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ <span class="text-red-500 font-semibold">*</span> –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
        </div>
        <div class="flex space-x-4">
          <a href="{% url 'inspector:lab_requests' %}" 
             class="inline-flex items-center px-6 py-3 border border-gray-300 rounded-lg text-gray-700 bg-white hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 focus:border-gray-500 transition-all duration-200 shadow-sm">
            <i class="fas fa-times mr-2"></i>
            –û—Ç–º–µ–Ω–∞
          </a>
          <button type="submit" id="submit-btn"
                  class="inline-flex items-center px-8 py-3 border border-transparent rounded-lg text-white bg-gradient-to-r from-purple-600 to-violet-600 hover:from-purple-700 hover:to-violet-700 focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
            <i class="fas fa-paper-plane mr-2"></i>
            <span id="submit-text">–°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É</span>
            <div id="loading-spinner" class="hidden ml-2">
              <i class="fas fa-spinner fa-spin"></i>
            </div>
          </button>
        </div>
      </div>
    </div>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(tomorrow.getDate() + 1);
    document.getElementById('expected_results_date').setAttribute('min', tomorrow.toISOString().split('T')[0]);
    
    // –£–ª—É—á—à–µ–Ω–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
    const form = document.getElementById('lab-request-form');
    const submitBtn = document.getElementById('submit-btn');
    const submitText = document.getElementById('submit-text');
    const loadingSpinner = document.getElementById('loading-spinner');
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    const requiredFields = ['project_id', 'material_type_id', 'reason', 'required_tests', 'sample_quantity', 'sampling_location_description'];
    
    function validateForm() {
        let isValid = true;
        requiredFields.forEach(fieldId => {
            const field = document.getElementById(fieldId);
            if (!field.value.trim()) {
                isValid = false;
                field.classList.add('border-red-300', 'ring-red-500');
                field.classList.remove('border-gray-300');
            } else {
                field.classList.remove('border-red-300', 'ring-red-500');
                field.classList.add('border-gray-300');
            }
        });
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–∫–∏
        if (isValid) {
            submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            submitBtn.disabled = false;
        } else {
            submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
            submitBtn.disabled = true;
        }
        
        return isValid;
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        field.addEventListener('input', validateForm);
        field.addEventListener('blur', validateForm);
    });
    
    // –ù–∞—á–∞–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
    validateForm();
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
    form.addEventListener('submit', function(e) {
        if (!validateForm()) {
            e.preventDefault();
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–µ—Ä–≤–æ–º—É –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º—É –ø–æ–ª—é
            const firstInvalidField = document.querySelector('.border-red-300');
            if (firstInvalidField) {
                firstInvalidField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                firstInvalidField.focus();
            }
            
            // –ü–æ–∫–∞–∑ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'error');
            return;
        }
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏
        submitText.textContent = '–°–æ–∑–¥–∞–µ–º –∑–∞—è–≤–∫—É...';
        loadingSpinner.classList.remove('hidden');
        submitBtn.disabled = true;
        submitBtn.classList.add('opacity-75');
    });
    
    // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞
    document.getElementById('project_id').addEventListener('change', function() {
        const projectName = this.options[this.selectedIndex].text;
        const locationField = document.getElementById('sampling_location_description');
        
        if (this.value && !locationField.value) {
            locationField.placeholder = `–£–∫–∞–∂–∏—Ç–µ –º–µ—Å—Ç–æ –Ω–∞ –æ–±—ä–µ–∫—Ç–µ: ${projectName}`;
        }
    });
    
    // –ê–≤—Ç–æ–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–Ω–∞–ª–∏–∑–æ–≤ –ø–æ —Ç–∏–ø—É –º–∞—Ç–µ—Ä–∏–∞–ª–∞
    document.getElementById('material_type_id').addEventListener('change', function() {
        const materialType = this.options[this.selectedIndex].text.toLowerCase();
        const testsField = document.getElementById('required_tests');
        
        if (this.value && !testsField.value) {
            let suggestedTests = '';
            
            if (materialType.includes('–±–µ—Ç–æ–Ω')) {
                suggestedTests = '–ü—Ä–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Å–∂–∞—Ç–∏–µ, –º–æ—Ä–æ–∑–æ—Å—Ç–æ–π–∫–æ—Å—Ç—å, –≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å';
            } else if (materialType.includes('–∞—Å—Ñ–∞–ª—å—Ç')) {
                suggestedTests = '–ü—Ä–æ—á–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –∫–æ–ª–µ–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é';
            } else if (materialType.includes('–≥—Ä—É–Ω—Ç')) {
                suggestedTests = '–ü–ª–æ—Ç–Ω–æ—Å—Ç—å, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏';
            } else if (materialType.includes('—Å—Ç–∞–ª—å')) {
                suggestedTests = '–ü—Ä–µ–¥–µ–ª –ø—Ä–æ—á–Ω–æ—Å—Ç–∏, –ø—Ä–µ–¥–µ–ª —Ç–µ–∫—É—á–µ—Å—Ç–∏, —Ö–∏–º–∏—á–µ—Å–∫–∏–π —Å–æ—Å—Ç–∞–≤';
            }
            
            if (suggestedTests) {
                testsField.value = suggestedTests;
                testsField.dispatchEvent(new Event('input'));
            }
        }
    });
    
    // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg text-white transform transition-all duration-300 translate-x-full`;
        
        if (type === 'error') {
            notification.classList.add('bg-red-500');
        } else if (type === 'success') {
            notification.classList.add('bg-green-500');
        } else {
            notification.classList.add('bg-blue-500');
        }
        
        notification.innerHTML = `
            <div class="flex items-center">
                <i class="fas fa-${type === 'error' ? 'exclamation-circle' : type === 'success' ? 'check-circle' : 'info-circle'} mr-2"></i>
                <span>${message}</span>
            </div>
        `;
        
        document.body.appendChild(notification);
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
        setTimeout(() => {
            notification.classList.remove('translate-x-full');
        }, 100);
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ
        setTimeout(() => {
            notification.classList.add('translate-x-full');
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 300);
        }, 5000);
    }
    
    console.log('üß™ Lab request form initialized');
});
</script>

{% endblock %}
